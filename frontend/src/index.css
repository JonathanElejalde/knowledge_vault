/**
 * Knowledge Vault - Design System Entry Point
 * 
 * This file imports all design tokens and sets up the base styles.
 * The token system enables easy theming and visual customization.
 */

@import 'tailwindcss';

/* Import design tokens */
@import './styles/tokens/colors.css';
@import './styles/tokens/spacing.css';
@import './styles/tokens/typography.css';
@import './styles/tokens/animations.css';
@import './styles/presets.css';

@custom-variant dark (&:is(.dark *));

/* ============================================
 * TAILWIND THEME CONFIGURATION
 * Maps CSS variables to Tailwind utilities
 * ============================================ */
@theme {
  /* Surface colors */
  --color-surface-ground: hsl(var(--surface-ground));
  --color-surface-base: hsl(var(--surface-base));
  --color-surface-raised: hsl(var(--surface-raised));
  --color-surface-overlay: hsl(var(--surface-overlay));
  --color-surface-sunken: hsl(var(--surface-sunken));

  /* Text colors */
  --color-text-primary: hsl(var(--text-primary));
  --color-text-secondary: hsl(var(--text-secondary));
  --color-text-tertiary: hsl(var(--text-tertiary));
  --color-text-muted: hsl(var(--text-muted));
  --color-text-inverse: hsl(var(--text-inverse));

  /* Accent colors */
  --color-accent-primary: hsl(var(--accent-primary));
  --color-accent-primary-hover: hsl(var(--accent-primary-hover));
  --color-accent-primary-subtle: hsl(var(--accent-primary-subtle));
  --color-accent-secondary: hsl(var(--accent-secondary));

  /* Semantic colors */
  --color-success: hsl(var(--semantic-success));
  --color-success-subtle: hsl(var(--semantic-success-subtle));
  --color-warning: hsl(var(--semantic-warning));
  --color-warning-subtle: hsl(var(--semantic-warning-subtle));
  --color-danger: hsl(var(--semantic-danger));
  --color-danger-subtle: hsl(var(--semantic-danger-subtle));
  --color-info: hsl(var(--semantic-info));
  --color-info-subtle: hsl(var(--semantic-info-subtle));

  /* Border colors */
  --color-border-subtle: hsl(var(--border-subtle));
  --color-border-default: hsl(var(--border-default));
  --color-border-strong: hsl(var(--border-strong));

  /* Mood colors */
  --color-mood-focus-bg: hsl(var(--mood-focus-bg));
  --color-mood-focus-border: hsl(var(--mood-focus-border));
  --color-mood-focus-accent: hsl(var(--mood-focus-accent));
  --color-mood-insight-bg: hsl(var(--mood-insight-bg));
  --color-mood-insight-border: hsl(var(--mood-insight-border));
  --color-mood-insight-accent: hsl(var(--mood-insight-accent));
  --color-mood-content-bg: hsl(var(--mood-content-bg));
  --color-mood-content-border: hsl(var(--mood-content-border));
  --color-mood-growth-bg: hsl(var(--mood-growth-bg));
  --color-mood-growth-border: hsl(var(--mood-growth-border));
  --color-mood-growth-accent: hsl(var(--mood-growth-accent));

  /* Legacy compatibility (maps to new tokens) */
  --color-background: hsl(var(--surface-ground));
  --color-foreground: hsl(var(--text-primary));
  --color-card: hsl(var(--surface-base));
  --color-card-foreground: hsl(var(--text-primary));
  --color-popover: hsl(var(--surface-overlay));
  --color-popover-foreground: hsl(var(--text-primary));
  --color-primary: hsl(var(--accent-primary));
  --color-primary-foreground: hsl(var(--text-inverse));
  --color-secondary: hsl(var(--surface-sunken));
  --color-secondary-foreground: hsl(var(--text-primary));
  --color-muted: hsl(var(--surface-sunken));
  --color-muted-foreground: hsl(var(--text-tertiary));
  --color-accent: hsl(var(--surface-sunken));
  --color-accent-foreground: hsl(var(--text-primary));
  --color-destructive: hsl(var(--semantic-danger));
  --color-destructive-foreground: hsl(var(--text-inverse));
  --color-border: hsl(var(--border-default));
  --color-input: hsl(var(--border-default));
  --color-ring: hsl(var(--accent-primary));

  /* Radius */
  --radius-lg: var(--radius-base);
  --radius-md: calc(var(--radius-base) - 2px);
  --radius-sm: calc(var(--radius-base) - 4px);

  /* Animation keyframes (accordion for Radix compatibility) */
  --animate-accordion-down: accordion-down 0.2s ease-out;
  --animate-accordion-up: accordion-up 0.2s ease-out;

  @keyframes accordion-down {
    from { height: 0; }
    to { height: var(--radix-accordion-content-height); }
  }
  @keyframes accordion-up {
    from { height: var(--radix-accordion-content-height); }
    to { height: 0; }
  }
}

/* ============================================
 * UTILITY CLASSES
 * ============================================ */
@utility container {
  margin-inline: auto;
  padding-inline: var(--layout-gutter);
  @media (width >= --theme(--breakpoint-sm)) {
    max-width: none;
  }
  @media (width >= 1400px) {
    max-width: 1400px;
  }
}

/* ============================================
 * BASE STYLES
 * ============================================ */
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: hsl(var(--border-subtle));
  }

  * {
    @apply border-border;
  }

  html {
    font-family: var(--font-sans);
    font-size: var(--text-base);
    line-height: var(--leading-normal);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  body {
    @apply bg-background text-foreground;
    font-family: var(--font-sans);
    line-height: var(--leading-relaxed);
    font-weight: var(--font-normal);
    color-scheme: light dark;
    font-synthesis: none;
    margin: 0;
  }

  /* Smooth theme transitions */
  html.theme-transitioning,
  html.theme-transitioning *,
  html.theme-transitioning *::before,
  html.theme-transitioning *::after {
    transition: background-color var(--motion-duration) var(--motion-ease),
                border-color var(--motion-duration) var(--motion-ease),
                color var(--motion-duration) var(--motion-ease) !important;
  }
}

/* ============================================
 * TYPOGRAPHY UTILITIES
 * ============================================ */
@layer utilities {
  .text-heading-1 {
    font-size: var(--heading-1-size);
    font-weight: var(--heading-1-weight);
    letter-spacing: var(--heading-1-tracking);
    line-height: var(--heading-1-leading);
  }

  .text-heading-2 {
    font-size: var(--heading-2-size);
    font-weight: var(--heading-2-weight);
    letter-spacing: var(--heading-2-tracking);
    line-height: var(--heading-2-leading);
  }

  .text-heading-3 {
    font-size: var(--heading-3-size);
    font-weight: var(--heading-3-weight);
    letter-spacing: var(--heading-3-tracking);
    line-height: var(--heading-3-leading);
  }

  .text-heading-4 {
    font-size: var(--heading-4-size);
    font-weight: var(--heading-4-weight);
    letter-spacing: var(--heading-4-tracking);
    line-height: var(--heading-4-leading);
  }

  .text-body {
    font-size: var(--body-size);
    font-weight: var(--body-weight);
    line-height: var(--body-leading);
  }

  .text-body-sm {
    font-size: var(--body-sm-size);
    font-weight: var(--body-sm-weight);
    line-height: var(--body-sm-leading);
  }

  .text-label {
    font-size: var(--label-size);
    font-weight: var(--label-weight);
    letter-spacing: var(--label-tracking);
  }

  .text-caption {
    font-size: var(--caption-size);
    font-weight: var(--caption-weight);
    letter-spacing: var(--caption-tracking);
  }

  .text-stat {
    font-size: var(--stat-size);
    font-weight: var(--stat-weight);
    letter-spacing: var(--stat-tracking);
  }
}

/* ============================================
 * LEGACY VARIABLE FALLBACKS
 * Ensures existing components work during migration
 * ============================================ */
@layer base {
  :root {
    --background: var(--surface-ground);
    --foreground: var(--text-primary);
    --card: var(--surface-base);
    --card-foreground: var(--text-primary);
    --popover: var(--surface-overlay);
    --popover-foreground: var(--text-primary);
    --primary: var(--accent-primary);
    --primary-foreground: 0 0% 100%;
    --secondary: var(--surface-sunken);
    --secondary-foreground: var(--text-primary);
    --muted: var(--surface-sunken);
    --muted-foreground: var(--text-tertiary);
    --accent: var(--surface-sunken);
    --accent-foreground: var(--text-primary);
    --destructive: var(--semantic-danger);
    --destructive-foreground: 0 0% 100%;
    --border: var(--border-default);
    --input: var(--border-default);
    --ring: var(--accent-primary);
    --radius: var(--radius-base);
  }
}
